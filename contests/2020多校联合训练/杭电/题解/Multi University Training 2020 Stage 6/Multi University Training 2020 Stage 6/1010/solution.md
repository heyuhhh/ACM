题目是求随机选出一个生成树的权值期望，突破点在于生成树的权值定义，是树上所有边权按位与之后的结果。期望最基础的性质就是期望的和等于和的期望，即$E(X + Y) = E(X) + E(Y)$。知道这个性质那么有一个很正常的想法就是拆位，因为每一位在按位与的过程中都是相互独立的。

现在我们直接枚举二进制的每一位$i$，对于这一位，如果$w_{u, v}$的第$i$位不为$0$，那么我们就直接在$u, v$直接连一条边。那么对于这张新图，每有一个生成树，那么都会对答案贡献$\frac{2^i}{sum}$，$sum$是指原图中生成树的个数。用无向图的矩阵树定理就能求出生成树的个数，这道题的整体复杂度是$O(Tn^3\log{w} )$。

